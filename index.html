<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Go File Server</title>
        <link
            href="https://cdn.jsdelivr.net/npm/daisyui@2.15.1/dist/full.css"
            rel="stylesheet"
            type="text/css"
        />
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body>
        <div class="container">
            <div class="max-w-xs m-5">
                <h1>Sorry, this page is password protected.</h1>
                <input
                    type="password"
                    id="password"
                    placeholder="Password"
                    class="input mt-2 input-bordered w-full btn-sm"
                />
                <button
                    class="btn btn-success btn-sm mt-2"
                    onClick="submitPassword()"
                >
                    Login
                </button>
            </div>
        </div>
        <script>
            function getPassword() {
                return document.querySelector("#password").value || "";
            }

            function submitPassword() {
                const path =
                    "http://localhost:8080/api/directory/" + getPassword();
                fetchAsync(path).then((response) => {
                    if (response.error) {
                        alert(response.error);
                    } else {
                        for (let i = 0; i < response.files.length; i++) {
                            console.log(response.files);
                            var url =
                                "http://localhost:8080/api/" +
                                response.files[i];
                            console.log(url);
                            var node = document.createElement("img");
                            node.src = url;
                            // Apend the image file
                            document.body.appendChild(node);
                        }
                    }
                });
            }

            async function fetchAsync(url) {
                let response = await fetch(url);
                let data = await response.json();
                return data;
            }
        </script>
    </body>
</html>
